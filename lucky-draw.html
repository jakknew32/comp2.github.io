<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéâ ‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</title>
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700;900&family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root{
  --white:#FFFFFF; --off:#F2F6FF;
  --blue:#1565C0; --blue2:#0D47A1; --blue-lt:#42A5F5; --blue-xl:#DDEEFF;
  --gold:#FFB300; --gold2:#FF8F00; --gold-lt:#FFE082;
  --text:#1A237E; --shadow:0 4px 24px rgba(21,101,192,0.13);
}
*{margin:0;padding:0;box-sizing:border-box;cursor:none !important;}
body{
  font-family:'Kanit',sans-serif;
  background:var(--off);
  min-height:100vh; color:var(--text); overflow-x:hidden;
  background-image:
    radial-gradient(ellipse at 8% 0%,rgba(21,101,192,0.11) 0%,transparent 52%),
    radial-gradient(ellipse at 92% 100%,rgba(255,179,0,0.10) 0%,transparent 52%),
    radial-gradient(ellipse at 55% 45%,rgba(66,165,245,0.06) 0%,transparent 50%);
}

/* ‚îÄ‚îÄ CURSOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
#cur{position:fixed;top:0;left:0;width:26px;height:36px;pointer-events:none;z-index:99999;
  transform:translate(-8px,-2px);
  filter:drop-shadow(0 2px 10px rgba(21,101,192,0.4)) drop-shadow(0 0 5px rgba(255,255,255,0.95));
  will-change:transform;}
#cur svg{width:100%;height:100%;}
.cur-trail{position:fixed;pointer-events:none;z-index:99998;border-radius:50%;
  background:radial-gradient(circle,rgba(255,255,255,0.88),rgba(66,165,245,0.28) 60%,transparent);
  transform:translate(-50%,-50%);animation:trFade .45s ease-out forwards;}
@keyframes trFade{0%{opacity:.75;transform:translate(-50%,-50%) scale(1);}100%{opacity:0;transform:translate(-50%,-50%) scale(.05);}}
.sp-particle{position:fixed;pointer-events:none;z-index:99997;border-radius:50%;transform-origin:center;
  animation:spOut .65s cubic-bezier(.25,.46,.45,.94) forwards;}
@keyframes spOut{0%{opacity:1;transform:translate(0,0) scale(1);}100%{opacity:0;transform:translate(var(--tx),var(--ty)) scale(0);}}
.sp-ring{position:fixed;pointer-events:none;z-index:99996;border-radius:50%;
  transform:translate(-50%,-50%) scale(0);animation:spRing .5s ease-out forwards;}
@keyframes spRing{0%{transform:translate(-50%,-50%) scale(0);opacity:1;}100%{transform:translate(-50%,-50%) scale(3.5);opacity:0;}}

/* ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
.container{position:relative;z-index:1;max-width:1380px;margin:0 auto;padding:18px 22px;
  display:grid;grid-template-columns:1fr 390px;gap:18px;min-height:100vh;}
header{grid-column:1/-1;text-align:center;padding:24px 0 6px;}
header h1{font-size:clamp(1.8rem,4.5vw,3.2rem);font-weight:900;
  background:linear-gradient(135deg,var(--blue2),var(--blue-lt),var(--gold),var(--blue));
  background-size:300% auto;-webkit-background-clip:text;-webkit-text-fill-color:transparent;
  background-clip:text;animation:shimmer 4s linear infinite;letter-spacing:-.02em;}
@keyframes shimmer{0%{background-position:0% center;}100%{background-position:300% center;}}
header p{font-family:'Sarabun',sans-serif;color:rgba(21,101,192,.48);font-size:.92rem;margin-top:4px;}

.card{background:#fff;border:1px solid rgba(21,101,192,.12);border-radius:22px;padding:20px;
  box-shadow:var(--shadow);}
.card-title{font-size:.95rem;font-weight:700;color:var(--blue);margin-bottom:12px;display:flex;align-items:center;gap:7px;}

/* ‚îÄ‚îÄ LEFT PANEL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
.left-panel{display:flex;flex-direction:column;gap:16px;}

.wheel-card{background:linear-gradient(145deg,#fff,var(--blue-xl));
  border:2px solid rgba(21,101,192,.18);border-radius:26px;padding:26px 20px 20px;
  display:flex;flex-direction:column;align-items:center;gap:14px;
  box-shadow:0 8px 40px rgba(21,101,192,.14),inset 0 1px 0 rgba(255,255,255,.9);}
.wheel-wrapper{position:relative;width:100%;max-width:390px;aspect-ratio:1;}
.wheel-ptr{position:absolute;top:-20px;left:50%;transform:translateX(-50%);
  width:0;height:0;border-left:15px solid transparent;border-right:15px solid transparent;
  border-top:40px solid var(--gold);
  filter:drop-shadow(0 4px 10px rgba(255,179,0,.65));z-index:10;}
canvas#wheel{width:100%;height:100%;border-radius:50%;
  box-shadow:0 0 0 6px rgba(255,179,0,.32),0 0 40px rgba(21,101,192,.2),0 8px 30px rgba(21,101,192,.14);}
.wheel-center{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  width:52px;height:52px;background:radial-gradient(circle,#fff,var(--blue-xl));
  border:3px solid var(--gold);border-radius:50%;
  box-shadow:0 0 22px rgba(255,179,0,.6),0 2px 8px rgba(21,101,192,.2);
  z-index:5;display:flex;align-items:center;justify-content:center;font-size:1.5rem;}

.spin-btn{width:100%;max-width:360px;padding:15px;
  background:linear-gradient(135deg,var(--blue),var(--blue2));
  border:2px solid rgba(255,179,0,.4);border-radius:18px;
  color:#fff;font-family:'Kanit',sans-serif;font-size:1.2rem;font-weight:700;letter-spacing:.05em;
  cursor:none;transition:all .2s;box-shadow:0 8px 28px rgba(21,101,192,.4);
  position:relative;overflow:hidden;}
.spin-btn::before{content:'';position:absolute;top:-50%;left:-60%;width:40%;height:200%;
  background:rgba(255,255,255,.18);transform:skewX(-20deg);transition:left .4s;}
.spin-btn:hover::before{left:120%;}
.spin-btn:hover{transform:translateY(-3px);box-shadow:0 14px 35px rgba(21,101,192,.5);border-color:var(--gold);}
.spin-btn:disabled{opacity:.5;transform:none;}

.result-strip{width:100%;max-width:390px;
  background:linear-gradient(135deg,rgba(21,101,192,.05),rgba(255,179,0,.05));
  border:1.5px solid rgba(21,101,192,.14);border-radius:16px;padding:13px 18px;
  min-height:68px;display:flex;flex-direction:column;align-items:center;justify-content:center;
  text-align:center;position:relative;overflow:hidden;}
.result-strip .w-wait{font-family:'Sarabun',sans-serif;color:rgba(21,101,192,.38);font-size:.86rem;}
.result-strip .w-name{font-size:1.4rem;font-weight:900;color:var(--blue);}
.result-strip .w-arrow{color:var(--gold);font-size:1.1rem;margin:1px 0;}
.result-strip .w-prize{font-size:.98rem;font-weight:700;color:var(--gold2);}

/* report */
.rpt-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:11px;}
.rpt-header h3{font-size:.92rem;font-weight:700;color:var(--blue);display:flex;align-items:center;gap:6px;}
.btn-row{display:flex;gap:7px;}
.bsm{padding:6px 13px;border-radius:10px;font-family:'Sarabun',sans-serif;font-size:.78rem;font-weight:600;cursor:none;transition:all .18s;border:none;}
.b-csv{background:linear-gradient(135deg,#2E7D32,#388E3C);color:#fff;box-shadow:0 3px 10px rgba(46,125,50,.3);}
.b-csv:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(46,125,50,.4);}
.b-txt{background:linear-gradient(135deg,#546E7A,#37474F);color:#fff;box-shadow:0 3px 10px rgba(0,0,0,.15);}
.b-txt:hover{transform:translateY(-1px);}
.b-rst{background:rgba(21,101,192,.08);border:1px solid rgba(21,101,192,.18) !important;color:var(--blue);}
.b-rst:hover{background:rgba(21,101,192,.15);}

.rpt-list{display:flex;flex-direction:column;gap:7px;max-height:280px;overflow-y:auto;padding-right:3px;}
.rpt-list::-webkit-scrollbar{width:3px;}
.rpt-list::-webkit-scrollbar-thumb{background:linear-gradient(var(--gold),var(--blue-lt));border-radius:2px;}
.rpt-item{display:flex;align-items:center;gap:11px;background:#fff;border:1px solid rgba(21,101,192,.10);
  border-radius:14px;padding:10px 13px;animation:popIn .4s cubic-bezier(.175,.885,.32,1.275);transition:box-shadow .2s;}
.rpt-item:hover{box-shadow:0 4px 16px rgba(21,101,192,.12);}
@keyframes popIn{0%{opacity:0;transform:scale(.85) translateY(10px);}100%{opacity:1;transform:scale(1) translateY(0);}}
.rpt-num{width:29px;height:29px;flex-shrink:0;background:linear-gradient(135deg,var(--gold),var(--gold2));
  border-radius:50%;display:flex;align-items:center;justify-content:center;
  font-size:.72rem;font-weight:800;color:#fff;box-shadow:0 2px 8px rgba(255,179,0,.3);}
.rpt-info{flex:1;}
.rpt-winner{font-size:.9rem;font-weight:700;color:var(--blue);}
.rpt-prize{font-size:.76rem;color:var(--gold2);font-family:'Sarabun',sans-serif;}
.rpt-time{font-size:.66rem;color:rgba(21,101,192,.38);font-family:'Sarabun',sans-serif;}
.rpt-empty{text-align:center;color:rgba(21,101,192,.28);font-family:'Sarabun',sans-serif;font-size:.86rem;padding:28px 0;}

/* ‚îÄ‚îÄ RIGHT PANEL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
.right-panel{display:flex;flex-direction:column;gap:16px;}
.lists-grid{display:grid;grid-template-columns:1fr 1fr;gap:13px;}
.list-card{background:#fff;border:1px solid rgba(21,101,192,.12);border-radius:18px;padding:15px;
  box-shadow:0 2px 12px rgba(21,101,192,.07);}
.list-card h3{font-size:.86rem;color:var(--blue);font-weight:700;margin-bottom:9px;
  display:flex;align-items:center;justify-content:space-between;}
.badge{background:linear-gradient(135deg,var(--gold),var(--gold2));color:#fff;
  padding:2px 9px;border-radius:20px;font-size:.68rem;font-weight:700;}
.item-list{display:flex;flex-direction:column;gap:5px;max-height:175px;overflow-y:auto;padding-right:3px;}
.item-list::-webkit-scrollbar{width:3px;}
.item-list::-webkit-scrollbar-thumb{background:var(--blue-lt);border-radius:2px;}
.list-item{display:flex;align-items:center;justify-content:space-between;
  background:var(--off);border:1px solid rgba(21,101,192,.07);border-radius:8px;
  padding:6px 10px;font-size:.8rem;font-family:'Sarabun',sans-serif;animation:slideIn .2s ease;}
@keyframes slideIn{from{opacity:0;transform:translateX(-8px);}to{opacity:1;transform:translateX(0);}}
.list-item.used{opacity:.33;text-decoration:line-through;}
.del-btn{background:none;border:none;color:rgba(200,50,50,.5);font-size:.88rem;cursor:none;transition:color .15s;padding:0 2px;}
.del-btn:hover{color:#e53935;}
.empty-hint{text-align:center;color:rgba(21,101,192,.28);font-size:.76rem;font-family:'Sarabun',sans-serif;padding:14px 0;}

/* setup card */
.setup-card{background:#fff;border:1.5px solid rgba(21,101,192,.14);border-radius:20px;padding:18px;
  box-shadow:0 2px 14px rgba(21,101,192,.07);}
.setup-grid{display:grid;grid-template-columns:1fr 1fr;gap:9px;margin-bottom:11px;}
.inp-g{display:flex;flex-direction:column;gap:4px;}
.inp-g label{font-size:.76rem;color:rgba(21,101,192,.5);font-family:'Sarabun',sans-serif;}
.inp-g input{background:var(--off);border:1.5px solid rgba(21,101,192,.15);border-radius:10px;
  padding:9px 12px;color:var(--text);font-family:'Sarabun',sans-serif;font-size:.86rem;outline:none;transition:all .2s;}
.inp-g input:focus{border-color:var(--blue-lt);box-shadow:0 0 0 3px rgba(66,165,245,.14);}

.btn-add{width:100%;padding:11px;background:linear-gradient(135deg,var(--blue),var(--blue2));
  border:none;border-radius:12px;color:#fff;font-family:'Kanit',sans-serif;
  font-size:.93rem;font-weight:700;cursor:none;transition:all .15s;box-shadow:0 4px 16px rgba(21,101,192,.3);}
.btn-add:hover{transform:translateY(-2px);box-shadow:0 8px 22px rgba(21,101,192,.4);}
.btn-add:active{transform:translateY(0);}

/* csv */
.csv-wrap{margin-top:13px;padding-top:12px;border-top:1px solid rgba(21,101,192,.09);}
.csv-drop{position:relative;border:2px dashed rgba(21,101,192,.2);border-radius:13px;
  padding:13px;text-align:center;cursor:none;transition:all .2s;background:var(--off);}
.csv-drop input[type=file]{position:absolute;inset:0;opacity:0;cursor:none;width:100%;height:100%;}
.csv-drop:hover,.csv-drop.dragover{border-color:var(--blue-lt);background:rgba(66,165,245,.05);box-shadow:0 0 16px rgba(66,165,245,.14);}
.csv-drop.loaded{border-color:var(--gold);background:rgba(255,179,0,.04);border-style:solid;}
.csv-icon{font-size:1.45rem;margin-bottom:3px;}
.csv-lbl{font-size:.78rem;color:rgba(21,101,192,.5);font-family:'Sarabun',sans-serif;line-height:1.4;}
.csv-type{font-size:.68rem;color:var(--blue-lt);margin-top:3px;}
.csv-hint{font-size:.68rem;color:rgba(21,101,192,.37);font-family:'Sarabun',sans-serif;margin-top:7px;line-height:1.5;text-align:center;}
.csv-hint code{background:rgba(21,101,192,.08);padding:1px 5px;border-radius:4px;color:var(--blue);}

/* confetti */
.cc{position:absolute;inset:0;pointer-events:none;overflow:hidden;border-radius:inherit;}
.cp{position:absolute;width:8px;height:8px;border-radius:2px;animation:cpFall 1.5s ease-out forwards;}
@keyframes cpFall{0%{transform:translateY(-20px) rotate(0deg);opacity:1;}100%{transform:translateY(160px) rotate(720deg);opacity:0;}}

/* toast */
.toast{position:fixed;bottom:26px;left:50%;transform:translateX(-50%) translateY(80px);
  background:linear-gradient(135deg,var(--blue),var(--blue2));
  border:1.5px solid rgba(255,179,0,.45);color:#fff;
  font-family:'Kanit',sans-serif;font-weight:600;font-size:.88rem;
  padding:10px 24px;border-radius:50px;z-index:9999;
  transition:transform .3s cubic-bezier(.175,.885,.32,1.275);
  pointer-events:none;white-space:nowrap;box-shadow:0 8px 28px rgba(21,101,192,.3);}
.toast.show{transform:translateX(-50%) translateY(0);}
.toast.err{border-color:rgba(229,57,53,.5);}

/* ‚îÄ‚îÄ POPUP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
.pop-overlay{display:none;position:fixed;inset:0;background:rgba(10,20,60,.76);
  z-index:1000;align-items:center;justify-content:center;backdrop-filter:blur(14px);}
.pop-overlay.show{display:flex;}

.pop-box{background:linear-gradient(145deg,#fff,#EEF4FF);
  border-radius:32px;padding:46px 42px 38px;text-align:center;
  max-width:500px;width:93%;position:relative;overflow:hidden;
  animation:popBounce .6s cubic-bezier(.175,.885,.32,1.275);
  box-shadow:0 0 0 4px rgba(255,179,0,.45),0 0 70px rgba(21,101,192,.28),0 22px 60px rgba(21,101,192,.32);}
@keyframes popBounce{0%{transform:scale(.3) rotate(-8deg);opacity:0;}
  60%{transform:scale(1.05) rotate(1deg);opacity:1;}
  80%{transform:scale(.97) rotate(-.5deg);}100%{transform:scale(1) rotate(0);}}

/* Animated rainbow border */
.pop-box::before{content:'';position:absolute;inset:-3px;border-radius:35px;z-index:-1;
  background:linear-gradient(135deg,var(--gold),var(--blue-lt),#FF416C,var(--blue),var(--gold2),var(--blue-lt),var(--gold));
  background-size:400% 400%;animation:bShimmer 2s linear infinite;}
@keyframes bShimmer{0%{background-position:0% 50%;}100%{background-position:400% 50%;}}

.pop-rays{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  width:700px;height:700px;pointer-events:none;z-index:-2;opacity:.06;
  animation:rSpin 5s linear infinite;}
@keyframes rSpin{from{transform:translate(-50%,-50%) rotate(0deg);}to{transform:translate(-50%,-50%) rotate(360deg);}}

.pop-confetti{position:absolute;inset:0;pointer-events:none;overflow:hidden;border-radius:32px;}

/* Trophy burst animation */
.pop-trophy{font-size:5.5rem;display:block;margin-bottom:6px;
  animation:trBounce .55s ease .35s infinite alternate,trAppear .5s ease both;}
@keyframes trAppear{from{transform:scale(0) rotate(-20deg);opacity:0;}to{transform:scale(1) rotate(0);opacity:1;}}
@keyframes trBounce{from{transform:translateY(0) scale(1) rotate(-3deg);}to{transform:translateY(-14px) scale(1.09) rotate(3deg);}}

.pop-tag{display:inline-block;background:linear-gradient(135deg,var(--gold),var(--gold2));
  color:#fff;font-size:.78rem;font-weight:700;padding:4px 16px;border-radius:20px;
  margin-bottom:12px;letter-spacing:.1em;box-shadow:0 3px 10px rgba(255,179,0,.4);
  animation:tagPop .35s ease .5s both;}
@keyframes tagPop{from{transform:scale(0);opacity:0;}to{transform:scale(1);opacity:1;}}

/* Pulsing glow behind winner name */
.pop-winner-wrap{position:relative;display:inline-block;}
.pop-winner-wrap::after{content:attr(data-name);position:absolute;inset:0;
  background:linear-gradient(135deg,var(--blue2),var(--blue-lt));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  filter:blur(12px);opacity:.4;animation:namePulse 1.2s ease infinite alternate;}
@keyframes namePulse{from{filter:blur(10px);opacity:.3;}to{filter:blur(18px);opacity:.6;}}

.pop-winner{font-size:2.7rem;font-weight:900;line-height:1.1;margin-bottom:6px;
  background:linear-gradient(135deg,var(--blue2),var(--blue-lt),var(--blue));
  background-size:200% auto;-webkit-background-clip:text;-webkit-text-fill-color:transparent;
  background-clip:text;animation:winSlide .4s ease .3s both,shimmer 2s linear infinite;}
@keyframes winSlide{from{transform:translateY(22px);opacity:0;}to{transform:translateY(0);opacity:1;}}

.pop-gets{font-size:.88rem;color:rgba(21,101,192,.48);font-family:'Sarabun',sans-serif;margin-bottom:5px;}

.pop-prize{font-size:1.55rem;font-weight:800;color:var(--gold2);margin-bottom:10px;
  animation:prSlide .4s ease .5s both;text-shadow:0 2px 10px rgba(255,143,0,.3);}
@keyframes prSlide{from{transform:translateY(16px);opacity:0;}to{transform:translateY(0);opacity:1;}}

/* Firework stars row */
.pop-stars{font-size:1.55rem;letter-spacing:.12em;margin-bottom:24px;
  animation:stPop .4s ease .7s both;}
@keyframes stPop{from{transform:scale(0);opacity:0;}to{transform:scale(1);opacity:1;}}

/* Number badge */
.pop-num{position:absolute;top:16px;right:18px;
  background:linear-gradient(135deg,var(--blue),var(--blue2));
  color:#fff;font-size:.72rem;font-weight:700;padding:4px 12px;border-radius:20px;}

.pop-close{padding:14px 50px;
  background:linear-gradient(135deg,var(--blue),var(--blue2));
  border:2px solid rgba(255,179,0,.45);border-radius:18px;color:#fff;
  font-family:'Kanit',sans-serif;font-size:1.1rem;font-weight:700;
  cursor:none;transition:all .2s;box-shadow:0 6px 22px rgba(21,101,192,.35);
  animation:closeBtn .4s ease .8s both;}
@keyframes closeBtn{from{transform:translateY(10px);opacity:0;}to{transform:translateY(0);opacity:1;}}
.pop-close:hover{transform:scale(1.07);box-shadow:0 10px 30px rgba(21,101,192,.5);border-color:var(--gold);}

/* responsive */
@media(max-width:900px){
  .container{grid-template-columns:1fr;}
  .right-panel{order:3;}
  .wheel-wrapper{max-width:300px;}
  .lists-grid{grid-template-columns:1fr 1fr;}
}
@media(max-width:600px){
  .setup-grid,.lists-grid{grid-template-columns:1fr;}
}
</style>
</head>
<body>

<!-- Cursor -->
<div id="cur">
  <svg viewBox="0 0 26 36" fill="none" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <radialGradient id="wg" cx="38%" cy="30%" r="65%">
        <stop offset="0%" stop-color="#FFFFFF"/>
        <stop offset="55%" stop-color="#E3F2FD" stop-opacity=".96"/>
        <stop offset="100%" stop-color="#BBDEFB" stop-opacity=".85"/>
      </radialGradient>
      <radialGradient id="ws" cx="28%" cy="22%" r="38%">
        <stop offset="0%" stop-color="#fff"/>
        <stop offset="100%" stop-color="#fff" stop-opacity="0"/>
      </radialGradient>
      <filter id="wf"><feGaussianBlur stdDeviation="1.1" result="b"/>
        <feComposite in="SourceGraphic" in2="b" operator="over"/></filter>
    </defs>
    <path d="M13 1C13 1,1 15,1 23C1 30.2 6.5 35 13 35C19.5 35 25 30.2 25 23C25 15 13 1 13 1Z"
      fill="url(#wg)" filter="url(#wf)" stroke="rgba(21,101,192,.22)" stroke-width=".8"/>
    <path d="M13 5C13 5,6 16,6 21C6 21,7.5 14,12 10Z" fill="url(#ws)" opacity=".8"/>
    <circle cx="17" cy="26" r="3" fill="rgba(255,255,255,.55)"/>
    <circle cx="15" cy="20" r="1.4" fill="rgba(255,255,255,.34)"/>
  </svg>
</div>

<div class="toast" id="toast"></div>

<!-- ‚îÄ‚îÄ POPUP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="pop-overlay" id="popOverlay" onclick="closePopup(event)">
  <div class="pop-box">
    <!-- Spinning rays SVG -->
    <svg class="pop-rays" viewBox="0 0 700 700">
      <g id="rays" transform="translate(350,350)"></g>
    </svg>
    <div class="pop-confetti" id="popConfetti"></div>
    <div class="pop-num" id="popNum">#1</div>
    <span class="pop-trophy">üèÜ</span>
    <div class="pop-tag">‚ú® ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡∏¥‡πà‡∏á! ‚ú®</div>
    <div class="pop-winner-wrap">
      <div class="pop-winner" id="popWinner">-</div>
    </div>
    <div class="pop-gets">‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</div>
    <div class="pop-prize" id="popPrize">-</div>
    <div class="pop-stars">üåü üéä üéâ üéÅ üéä üåü</div>
    <button class="pop-close" onclick="closePopup()">üéâ ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö!</button>
  </div>
</div>

<!-- ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="container">
  <header>
    <h1>üéä ‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h1>
    <p>‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠ ‚Äî ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô ‚Äî ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
  </header>

  <!-- LEFT: wheel ‚Üí report -->
  <div class="left-panel">

    <div class="wheel-card">
      <div class="wheel-wrapper">
        <div class="wheel-ptr"></div>
        <canvas id="wheel" width="600" height="600"></canvas>
        <div class="wheel-center">‚≠ê</div>
      </div>
      <button class="spin-btn" id="spinBtn" onclick="spinWheel()">üé∞ ‡∏´‡∏°‡∏∏‡∏ô‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å!</button>
      <div class="result-strip" id="resultBanner">
        <div class="cc" id="bannerCC"></div>
        <div class="w-wait">‡∏Å‡∏î "‡∏´‡∏°‡∏∏‡∏ô‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å!" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</div>
      </div>
    </div>

    <div class="card">
      <div class="rpt-header">
        <h3>üìã ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å</h3>
        <div class="btn-row">
          <button class="bsm b-csv" onclick="exportCSV()">üìä Export CSV</button>
          <button class="bsm b-txt" onclick="exportTxt()">üìÑ Export TXT</button>
          <button class="bsm b-rst" onclick="resetAll()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
        </div>
      </div>
      <div class="rpt-list" id="rptList">
        <div class="rpt-empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å</div>
      </div>
    </div>
  </div>

  <!-- RIGHT: lists ‚Üí setup -->
  <div class="right-panel">

    <div class="lists-grid">
      <div class="list-card">
        <h3>üë• ‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏° <span class="badge" id="pCount">0</span></h3>
        <div class="item-list" id="pList"><div class="empty-hint">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</div></div>
      </div>
      <div class="list-card">
        <h3>üéÅ ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• <span class="badge" id="prCount">0</span></h3>
        <div class="item-list" id="prList"><div class="empty-hint">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</div></div>
      </div>
    </div>

    <div class="setup-card">
      <div class="card-title">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</div>
      <div class="setup-grid">
        <div class="inp-g">
          <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</label>
          <input type="text" id="pInput" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏¢ ‡∏Å."/>
        </div>
        <div class="inp-g">
          <label>‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label>
          <input type="text" id="prInput" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ö‡∏±‡∏ï‡∏£‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç"/>
        </div>
      </div>
      <button class="btn-add" onclick="addItems()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏° &amp; ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>
      <div class="csv-wrap">
        <div class="csv-drop" id="csvDrop"
          ondragover="onDragOver(event)" ondragleave="onDragLeave()" ondrop="onDrop(event)">
          <input type="file" accept=".csv,text/csv" onchange="onFileSelect(event)"/>
          <div class="csv-icon">üìÇ</div>
          <div class="csv-lbl" id="csvLbl">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å CSV ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß<br>
            <span style="color:var(--blue-lt);font-size:.7rem;">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</span></div>
          <div class="csv-type">‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 1 = ‡∏ä‡∏∑‡πà‡∏≠ &nbsp;|&nbsp; ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 2 = ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</div>
        </div>
        <div class="csv-hint">
          ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: <code>‡∏ô‡∏≤‡∏¢ ‡∏Å.,‡∏ö‡∏±‡∏ï‡∏£‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç 500</code> | <code>‡∏ô‡∏≤‡∏á ‡∏Ç.,iPad</code>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
// ‚îÄ‚îÄ Build SVG rays in popup ‚îÄ‚îÄ
(()=>{
  const g=document.getElementById('rays');
  for(let i=0;i<20;i++){
    const a=(i/20)*360;
    const line=document.createElementNS('http://www.w3.org/2000/svg','line');
    line.setAttribute('x1','0');line.setAttribute('y1','60');
    line.setAttribute('x2','0');line.setAttribute('y2','320');
    line.setAttribute('stroke',i%2===0?'#FFB300':'#1565C0');
    line.setAttribute('stroke-width','18');
    line.setAttribute('transform',`rotate(${a})`);
    g.appendChild(line);
  }
})();

// ‚îÄ‚îÄ DATA ‚îÄ‚îÄ
let participants=[], prizes=[], results=[], isSpinning=false, currentWheelItems=[];

// ‚îÄ‚îÄ CURSOR ‚îÄ‚îÄ
const curEl=document.getElementById('cur');
document.addEventListener('mousemove',e=>{
  curEl.style.left=e.clientX+'px'; curEl.style.top=e.clientY+'px';
  const t=document.createElement('div'); t.className='cur-trail';
  const sz=5+Math.random()*7;
  t.style.cssText=`width:${sz}px;height:${sz}px;left:${e.clientX}px;top:${e.clientY}px;`;
  document.body.appendChild(t); setTimeout(()=>t.remove(),450);
});
document.addEventListener('mousedown',()=>{curEl.style.transform='translate(-8px,-2px) scale(.82)';});
document.addEventListener('mouseup',()=>{curEl.style.transform='translate(-8px,-2px) scale(1)';});

// ‚îÄ‚îÄ SPLASH ‚îÄ‚îÄ
const SC=['#fff','#E3F2FD','#42A5F5','#FFB300','#FFE082','#1565C0','#BBDEFB','#FF416C','#69F0AE'];
document.addEventListener('click',e=>{
  const x=e.clientX,y=e.clientY;
  [0,1].forEach(i=>{
    const r=document.createElement('div'); r.className='sp-ring';
    const sz=(28+i*14)+Math.random()*12;
    r.style.cssText=`width:${sz}px;height:${sz}px;left:${x}px;top:${y}px;border:2px solid ${SC[i*3]};animation-delay:${i*.07}s;`;
    document.body.appendChild(r); setTimeout(()=>r.remove(),600);
  });
  const cnt=18+Math.floor(Math.random()*10);
  for(let i=0;i<cnt;i++){
    const p=document.createElement('div'); p.className='sp-particle';
    const angle=(i/cnt)*Math.PI*2+(Math.random()-.5)*.5;
    const dist=42+Math.random()*72;
    const tx=Math.cos(angle)*dist,ty=Math.sin(angle)*dist;
    const sz=4+Math.random()*9,col=SC[Math.floor(Math.random()*SC.length)];
    const drop=Math.random()>.5;
    p.style.cssText=`width:${drop?sz*.65:sz}px;height:${drop?sz*1.5:sz}px;left:${x}px;top:${y}px;background:${col};
      border-radius:${drop?'50% 50% 50% 50% / 40% 40% 60% 60%':'50%'};
      --tx:${tx}px;--ty:${ty}px;animation-delay:${Math.random()*.06}s;animation-duration:${.4+Math.random()*.3}s;
      box-shadow:0 0 6px ${col}80;`;
    document.body.appendChild(p); setTimeout(()=>p.remove(),800);
  }
});

// ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ
function toast(msg,err=false){
  const t=document.getElementById('toast');
  t.textContent=msg; t.className='toast'+(err?' err':'');
  t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),3200);
}

// ‚îÄ‚îÄ CSV IMPORT ‚îÄ‚îÄ
function parseCSV2(text){
  const d=text.includes('\t')?'\t':text.includes(';')?';':',';
  const lines=text.split(/\r?\n/).map(l=>l.trim()).filter(Boolean);
  const rows=[];
  for(const line of lines){
    const cols=[];let cur='',inQ=false;
    for(let i=0;i<line.length;i++){
      const c=line[i];
      if(c==='"'){inQ=!inQ;continue;}
      if(c===d&&!inQ){cols.push(cur.trim());cur='';continue;}
      cur+=c;
    }
    cols.push(cur.trim()); rows.push(cols);
  }
  const hdr=['‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','prize','‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','reward','‡∏ä‡∏∑‡πà‡∏≠','name','participant'];
  let s=0;
  if(rows.length>1&&rows[0][1]&&hdr.some(w=>rows[0][1].toLowerCase().includes(w))) s=1;
  const p=[],pr=[];
  for(let i=s;i<rows.length;i++){
    if(rows[i][0]) p.push(rows[i][0]);
    if(rows[i][1]) pr.push(rows[i][1]);
  }
  return{participants:p,prizes:pr};
}
function importFile(file){
  new FileReader().addEventListener('load',e=>{
    try{
      const{participants:np,prizes:npr}=parseCSV2(e.target.result);
      if(!np.length&&!npr.length){toast('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå',true);return;}
      let ap=0,apr=0;
      np.forEach(i=>{if(i&&!participants.includes(i)){participants.push(i);ap++;}});
      npr.forEach(i=>{if(i&&!prizes.includes(i)){prizes.push(i);apr++;}});
      renderLists(); drawWheel();
      document.getElementById('csvDrop').classList.add('loaded');
      document.getElementById('csvLbl').innerHTML=`‚úÖ <strong>${file.name}</strong><br><span style="font-size:.7rem;color:var(--blue)">üë§ ${ap} ‡∏Ñ‡∏ô | üéÅ ${apr} ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</span>`;
      toast(`‚úÖ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Äî ${ap} ‡∏Ñ‡∏ô, ${apr} ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•`);
    }catch(err){toast('‚ùå ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',true);}
  });
  (new FileReader()).onload=function(e){
    try{
      const{participants:np,prizes:npr}=parseCSV2(e.target.result);
      if(!np.length&&!npr.length){toast('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå',true);return;}
      let ap=0,apr=0;
      np.forEach(i=>{if(i&&!participants.includes(i)){participants.push(i);ap++;}});
      npr.forEach(i=>{if(i&&!prizes.includes(i)){prizes.push(i);apr++;}});
      renderLists(); drawWheel();
      document.getElementById('csvDrop').classList.add('loaded');
      document.getElementById('csvLbl').innerHTML=`‚úÖ <strong>${file.name}</strong><br><span style="font-size:.7rem;color:var(--blue)">üë§ ${ap} ‡∏Ñ‡∏ô | üéÅ ${apr} ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</span>`;
      toast(`‚úÖ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Äî ${ap} ‡∏Ñ‡∏ô, ${apr} ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•`);
    }catch(err){toast('‚ùå ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',true);}
  };
  const fr=new FileReader();
  fr.onload=e=>{
    try{
      const{participants:np,prizes:npr}=parseCSV2(e.target.result);
      if(!np.length&&!npr.length){toast('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå',true);return;}
      let ap=0,apr=0;
      np.forEach(i=>{if(i&&!participants.includes(i)){participants.push(i);ap++;}});
      npr.forEach(i=>{if(i&&!prizes.includes(i)){prizes.push(i);apr++;}});
      renderLists(); drawWheel();
      document.getElementById('csvDrop').classList.add('loaded');
      document.getElementById('csvLbl').innerHTML=`‚úÖ <strong>${file.name}</strong><br><span style="font-size:.7rem;color:var(--blue)">üë§ ${ap} ‡∏Ñ‡∏ô | üéÅ ${apr} ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</span>`;
      toast(`‚úÖ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Äî ${ap} ‡∏Ñ‡∏ô, ${apr} ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•`);
    }catch(err){toast('‚ùå ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',true);}
  };
  fr.readAsText(file,'UTF-8');
}
function onFileSelect(e){const f=e.target.files[0];if(f)importFile(f);e.target.value='';}
function onDragOver(e){e.preventDefault();document.getElementById('csvDrop').classList.add('dragover');}
function onDragLeave(){document.getElementById('csvDrop').classList.remove('dragover');}
function onDrop(e){
  e.preventDefault(); document.getElementById('csvDrop').classList.remove('dragover');
  const f=e.dataTransfer.files[0];
  if(!f||!f.name.toLowerCase().endsWith('.csv')){toast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå .csv',true);return;}
  importFile(f);
}

// ‚îÄ‚îÄ ADD ITEMS ‚îÄ‚îÄ
function addItems(){
  const pI=document.getElementById('pInput'),prI=document.getElementById('prInput');
  const pV=pI.value.trim(),prV=prI.value.trim();
  if(!pV&&!prV){toast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',true);return;}
  if(pV){participants.push(pV);pI.value='';}
  if(prV){prizes.push(prV);prI.value='';}
  renderLists(); drawWheel();
}
['pInput','prInput'].forEach(id=>document.getElementById(id).addEventListener('keydown',e=>{if(e.key==='Enter')addItems();}));

function renderLists(){
  const usedP=results.map(r=>r.winner),usedPr=results.map(r=>r.prize);
  document.getElementById('pCount').textContent=participants.length;
  document.getElementById('prCount').textContent=prizes.length;
  const pEl=document.getElementById('pList'),prEl=document.getElementById('prList');
  if(!participants.length){pEl.innerHTML='<div class="empty-hint">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</div>';}
  else pEl.innerHTML=participants.map((it,i)=>`<div class="list-item ${usedP.includes(it)?'used':''}">
    <span>${it}</span><button class="del-btn" onclick="delItem('p',${i})">‚úï</button></div>`).join('');
  if(!prizes.length){prEl.innerHTML='<div class="empty-hint">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</div>';}
  else prEl.innerHTML=prizes.map((it,i)=>`<div class="list-item ${usedPr.includes(it)?'used':''}">
    <span>${it}</span><button class="del-btn" onclick="delItem('pr',${i})">‚úï</button></div>`).join('');
}
function delItem(t,i){
  if(t==='p')participants.splice(i,1); else prizes.splice(i,1);
  renderLists(); drawWheel();
}

// ‚îÄ‚îÄ WHEEL ‚îÄ‚îÄ
const canvas=document.getElementById('wheel'), ctx=canvas.getContext('2d');
const COLORS=[
  '#FF416C','#FF6B35','#F7B731','#20BF6B','#0984E3','#A29BFE','#FD79A8','#00CEC9',
  '#6C5CE7','#FDCB6E','#E17055','#00B894','#74B9FF','#D63031','#00B0FF','#FF4081',
  '#76FF03','#FF6D00','#EA80FC','#18FFFF','#FFD740','#69F0AE','#FF1744','#40C4FF'
];

function drawSegs(items,rotOff=0){
  const n=items.length,arc=(2*Math.PI)/n;
  const W=canvas.width,H=canvas.height,cx=W/2,cy=H/2,r=W/2-8;
  for(let i=0;i<n;i++){
    const s=i*arc-Math.PI/2+rotOff, e2=s+arc, col=COLORS[i%COLORS.length];
    ctx.beginPath(); ctx.moveTo(cx,cy); ctx.arc(cx,cy,r,s,e2); ctx.closePath();
    ctx.fillStyle=col; ctx.fill();
    const g=ctx.createRadialGradient(cx,cy,r*.25,cx,cy,r);
    g.addColorStop(0,'rgba(255,255,255,.2)'); g.addColorStop(1,'rgba(0,0,0,.1)');
    ctx.fillStyle=g; ctx.fill();
    ctx.strokeStyle='rgba(255,255,255,.6)'; ctx.lineWidth=2; ctx.stroke();
    ctx.save(); ctx.translate(cx,cy); ctx.rotate(s+arc/2);
    ctx.textAlign='right'; ctx.fillStyle='#fff';
    ctx.font=`bold ${Math.min(20,270/n)}px Kanit,sans-serif`;
    ctx.shadowColor='rgba(0,0,0,.6)'; ctx.shadowBlur=5;
    const lbl=items[i].length>12?items[i].slice(0,12)+'‚Ä¶':items[i];
    ctx.fillText(lbl,r-14,7); ctx.restore();
  }
  ctx.beginPath(); ctx.arc(cx,cy,r,0,2*Math.PI);
  ctx.strokeStyle='rgba(255,255,255,.75)'; ctx.lineWidth=7; ctx.stroke();
  ctx.beginPath(); ctx.arc(cx,cy,r+2,0,2*Math.PI);
  ctx.strokeStyle='rgba(255,179,0,.55)'; ctx.lineWidth=3; ctx.stroke();
}

function drawWheel(){
  const used=results.map(r=>r.winner);
  const avail=participants.filter(p=>!used.includes(p));
  currentWheelItems=avail.length?avail:['‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°'];
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawSegs(currentWheelItems);
}
drawWheel();

// ‚îÄ‚îÄ SPIN ‚îÄ‚îÄ
let rot=0;
function spinWheel(){
  const usedP=results.map(r=>r.winner),availP=participants.filter(p=>!usedP.includes(p));
  const usedPr=results.map(r=>r.prize),availPr=prizes.filter(p=>!usedPr.includes(p));
  if(!participants.length) return toast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡πà‡∏≠‡∏ô!',true);
  if(!prizes.length)       return toast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Å‡πà‡∏≠‡∏ô!',true);
  if(!availP.length)       return toast('‚úÖ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏•‡πâ‡∏ß!');
  if(!availPr.length)      return toast('‚úÖ ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß!');
  if(isSpinning) return;
  isSpinning=true; document.getElementById('spinBtn').disabled=true;

  const n=currentWheelItems.length,arc=(2*Math.PI)/n;
  const wi=Math.floor(Math.random()*n);
  const total=(6+Math.random()*5)*2*Math.PI;
  const target=total-(wi*arc+arc/2)-(rot%(2*Math.PI));
  const finalR=rot+target+2*Math.PI;
  const dur=4200+Math.random()*1000, t0=performance.now(), r0=rot;

  function ease(t){return 1-Math.pow(1-t,4.5);}
  function frame(now){
    const prog=Math.min((now-t0)/dur,1), ep=ease(prog);
    rot=r0+(finalR-r0)*ep;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.save(); ctx.translate(canvas.width/2,canvas.height/2);
    ctx.rotate(rot); ctx.translate(-canvas.width/2,-canvas.height/2);
    drawSegs(currentWheelItems); ctx.restore();
    if(prog<1){requestAnimationFrame(frame);}
    else{rot=finalR;isSpinning=false;document.getElementById('spinBtn').disabled=false;announce(wi);}
  }
  requestAnimationFrame(frame);
}

// ‚îÄ‚îÄ ANNOUNCE ‚îÄ‚îÄ
function announce(idx){
  const winner=currentWheelItems[idx];
  const usedPr=results.map(r=>r.prize),availPr=prizes.filter(p=>!usedPr.includes(p));
  const prize=availPr[Math.floor(Math.random()*availPr.length)];
  const now=new Date();
  const timeStr=now.toLocaleTimeString('th-TH',{hour:'2-digit',minute:'2-digit',second:'2-digit'});
  const dateStr=now.toLocaleDateString('th-TH',{day:'2-digit',month:'2-digit',year:'numeric'});
  const entry={winner,prize,time:timeStr,date:dateStr,num:results.length+1};
  results.push(entry);
  // banner
  const b=document.getElementById('resultBanner');
  b.innerHTML=`<div class="cc" id="bannerCC"></div>
    <div class="w-name">üéâ ${winner}</div>
    <div class="w-arrow">‚ñº</div>
    <div class="w-prize">üéÅ ${prize}</div>`;
  confetti('bannerCC',28);
  addRow(entry); showPopup(winner,prize,entry.num);
  renderLists(); drawWheel();
}

function addRow(e){
  const list=document.getElementById('rptList');
  const em=list.querySelector('.rpt-empty');if(em)em.remove();
  const d=document.createElement('div'); d.className='rpt-item';
  d.innerHTML=`<div class="rpt-num">${e.num}</div>
    <div class="rpt-info">
      <div class="rpt-winner">üë§ ${e.winner}</div>
      <div class="rpt-prize">üéÅ ${e.prize}</div>
    </div>
    <div class="rpt-time">${e.time}</div>`;
  list.insertBefore(d,list.firstChild);
}

// ‚îÄ‚îÄ POPUP ‚îÄ‚îÄ
function showPopup(winner,prize,num){
  document.getElementById('popWinner').textContent=winner;
  document.getElementById('popPrize').textContent='üéÅ '+prize;
  document.getElementById('popNum').textContent='#'+num;
  document.getElementById('popOverlay').classList.add('show');
  bigConfetti('popConfetti');
}
function closePopup(e){
  if(!e||e.target===document.getElementById('popOverlay')||e.currentTarget.tagName==='BUTTON')
    document.getElementById('popOverlay').classList.remove('show');
}

// ‚îÄ‚îÄ CONFETTI ‚îÄ‚îÄ
const CC=['#FFB300','#1565C0','#42A5F5','#FF416C','#20BF6B','#A29BFE','#fff','#FF6B35','#FDCB6E','#FF4081','#69F0AE'];
function confetti(id,n){
  const c=document.getElementById(id);if(!c)return; c.innerHTML='';
  for(let i=0;i<n;i++){
    const p=document.createElement('div'); p.className='cp';
    p.style.left=Math.random()*100+'%'; p.style.top='-10px';
    p.style.background=CC[Math.floor(Math.random()*CC.length)];
    p.style.animationDelay=Math.random()*.5+'s';
    p.style.animationDuration=(.9+Math.random()*.8)+'s';
    const sz=6+Math.random()*6+'px';
    p.style.width=sz; p.style.height=sz;
    p.style.transform=`rotate(${Math.random()*360}deg)`;
    p.style.borderRadius=Math.random()>.5?'50%':'3px';
    c.appendChild(p);
  }
}
function bigConfetti(id){
  const c=document.getElementById(id);if(!c)return; c.innerHTML='';
  for(let i=0;i<70;i++){
    const p=document.createElement('div'); p.className='cp';
    p.style.left=Math.random()*100+'%'; p.style.top='-12px';
    p.style.background=CC[Math.floor(Math.random()*CC.length)];
    p.style.animationDelay=Math.random()*1.2+'s';
    p.style.animationDuration=(1+Math.random()*1.3)+'s';
    p.style.width=(7+Math.random()*9)+'px';
    p.style.height=(7+Math.random()*15)+'px';
    p.style.transform=`rotate(${Math.random()*360}deg)`;
    p.style.borderRadius=Math.random()>.4?'50%':'2px';
    c.appendChild(p);
  }
}

// ‚îÄ‚îÄ EXPORT CSV ‚îÄ‚îÄ
function exportCSV(){
  if(!results.length){toast('‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å',true);return;}
  let csv='\uFEFF';
  csv+='‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà,‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà,‡πÄ‡∏ß‡∏•‡∏≤,‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\n';
  results.forEach(r=>{csv+=`${r.num},"${r.date}","${r.time}","${r.winner}","${r.prize}"\n`;});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv;charset=utf-8'}));
  a.download='lucky-draw-report.csv'; a.click();
  toast('‚úÖ Export CSV ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
}

// ‚îÄ‚îÄ EXPORT TXT ‚îÄ‚îÄ
function exportTxt(){
  if(!results.length){toast('‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å',true);return;}
  let txt='‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n     ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n';
  results.forEach(r=>{
    txt+=`‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà ${r.num}  [${r.date} ${r.time}]\n  ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• : ${r.winner}\n  ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•       : ${r.prize}\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
  });
  txt+=`\n‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${results.length} ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•`;
  const a=document.createElement('a');
  a.href=URL.createObjectURL(new Blob(['\ufeff'+txt],{type:'text/plain;charset=utf-8'}));
  a.download='lucky-draw-report.txt'; a.click();
  toast('‚úÖ Export TXT ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
}

// ‚îÄ‚îÄ RESET ‚îÄ‚îÄ
function resetAll(){
  if(!confirm('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?'))return;
  results=[];
  document.getElementById('rptList').innerHTML='<div class="rpt-empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å</div>';
  document.getElementById('resultBanner').innerHTML='<div class="cc" id="bannerCC"></div><div class="w-wait">‡∏Å‡∏î "‡∏´‡∏°‡∏∏‡∏ô‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å!" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</div>';
  renderLists(); drawWheel();
}
</script>
</body>
</html>